<img width="1913" height="1029" alt="엔진2" src="https://github.com/user-attachments/assets/edf87c9e-08ed-45e9-8344-39c894548087" />
윈도우
<img width="1027" height="796" alt="리눅스" src="https://github.com/user-attachments/assets/fbb6d71c-f228-483b-97e1-7e53c458fdc9" />
리눅스
<img width="1070" height="849" alt="스크린샷 2025-09-15 155939" src="https://github.com/user-attachments/assets/32fd5787-f8d8-4a80-8e09-69b818bb705c" />
멀티플레이 테스팅

https://youtu.be/-ZEik9VYwIc

# 개요
유명한 MMORPG 메이플스토리를 ShellEngine을 이용해 모작 해본 프로젝트입니다.</br>
서버-클라이언트 구조로, 클라이언트가 입력 패킷을 보내고 서버가 처리 후 계산하여 상태 패킷을 클라이언트에게 보냅니다.</br>
매크로와 CMake 타겟을 통해 서버 사이드와 클라이언트 사이드 코드를 분리하여 관리합니다.</br>

- 개발 언어: C++17
- 엔진: [ShellEngine](https://github.com/Shell4026/ShellEngine) (직접 개발, CMake 빌드 관리)
- 네트워크: ASIO 기반 UDP, TCP
- 지원 플랫폼: Windows, Linux
- 구현 기능: 멀티월드, 플레이어 이동/보간, NPC 대화창, 인벤토리(서버와 DB연결), FSM기반 몬스터 AI, 스킬/히트 시스템, 아이템

에셋은 포함 돼 있지 않습니다

# 상세
## 주요 시스템
- **멀티 월드 서버**
  - 기존 ShellEngine이 단일 월드만 업데이트하던 구조를 개선해 여러 월드를 동시에 시뮬레이션 가능하도록 확장
  - 서버에서는 렌더링 관련 컴포넌트를 비활성화하여 리소스를 절약
- **낮은 결합도 - Event Bus**
  - 중앙 Event Bus를 도입하여 네트워크 레이어와 게임 로직 컴포넌트간의 직접 참조를 제거
  - 수신된 패킷을 PacketEvent로 발행하면 필요한 컴포넌트만 구독해서 처리
- **패킷 ID 자동 부여**
  - 클래스명 기반 컴파일타임 해시를 사용해 패킷 ID를 자동으로 생성(런타임 오버헤드 없음)
- **AI: 전략 패턴 + FSM**
  - AIStrategy 인터페이스로 행동 패턴을 추상화하여 확장성을 확보
  - 서버에서 FSM 기반으로 AI를 실행하고, 클라이언트에는 상태/위치만 전송
- **동적 폰트 생성**
  - 채팅/이름표 등 런타임에 등장하는 유니코드 문자에 대응하기 위해 필요 시 폰트 아틀라스(이미지)를 동적으로 생성하고 교체
  - shared_ptr을 통해 폰트 객체를 전역적으로 관리하고 모든 사용처가 사라질 시 제거
  
## 플레이어
- 입력 전송 최적화
  - 매 프레임 전송 대신 입력 상태가 변경될 때만 PlayerInputPacket을 전송
- 서버 시뮬레이션
  - 서버에서 동일한 물리/로직을 돌려 입력을 처리하고, 특정 조건(주기 또는 중요 이벤트)에서 상태 패킷을 브로드캐스트
- 클라이언트 보간
  - 클라이언트는 서버가 보낸 마지막 위치/속도에 대해 매프레임 선형 보간을 수행하여 부드러운 움직임을 보장
- 바닥 감지
  - raycast + 충돌체크 혼합 방식으로 안정적인 바닥 감지 구현
  - 플레이어의 발 보다 살짝 위에서 레이캐스팅을 수행하여 살짝 바닥을 뚫고 아래로 내려갔을 때 다른 콜라이더를 감지하지 않음
- 플레이어 입장 / 퇴장
  - 플레이어가 접속하면 서버측에서 모든 유저에게 통일된 UUID를 부여
  - 비정상 종료 대비: 클라이언트는 1초마다 하트비트 전송, 서버는 주기적으로 하트비트를 감소/증가 관리
- 스킬 & 히트 시스템
  - 클라이언트는 스킬 사용 시 우선 애니메이션을 재생하고 SkillUsingPacket을 서버로 전송
  - 서버에서 스킬 발동을 처리 후 SkillStatePacket을 브로드캐스트하며, 히트박스 충돌이 발생하면 MobHitPacket을 전송
  - 몹에 가해진 충격(넉백, 경직) 등은 서버에서 물리적으로 처리
- 애니메이션
  - 현재는 컴포넌트 기반으로 간단한 애니메이션 시스템을 구현
  - 향후 에디터에서 편집 가능한 FSM 기반 애니메이션 시스템을 엔진에 직접 구현할 계획
